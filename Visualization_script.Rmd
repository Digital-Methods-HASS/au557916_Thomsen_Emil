---
title: "Visualizing Abortions in Denmark"
author: "Emil"
date: "26/11/2020"
output:
  html_document: default
  word_document: default
  pdf_document: default
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```



```{r Loading packeges}

library(tidyverse)
library(gganimate)
library(gifski) 
library(ggplot2)
library(shiny)
library(plotly)

```




Now that we have the tools we need from the library, we will download the data we would like to visualize

```{r uploading files}
finaldflink <- "https://raw.githubusercontent.com/Digital-Methods-HASS/au557916_Thomsen_Emil/main/final_df.csv"
finaldf05_18link <- "https://raw.githubusercontent.com/Digital-Methods-HASS/au557916_Thomsen_Emil/main/final_df05_18.csv"

final_df <- read_csv(url(finaldflink))
final_df05_18 <- read_csv(url(finaldf05_18link))

#head(final_df,26)
#head(final_df05_18, 26) #Checking if the data looks as it tt
```





The code chunk below uses our final dataset to show the development in abortions per capita in procent along with the average income in the different municipalities in Denmark.

```{r Visualization 1. Devellopment if income and abortions 1995-2018}
options(scipen=999) #By adding this line of code we disable the scientific way of writing lables.
ggplot(final_df, aes(x = av_Income, y = allAges, size = av_Income))+
  geom_point() + 
 # scale_x_log10() + 
  transition_time(Year) + 
  labs(title = "Visualization 1: Income and Abortions in {closest_state}", x = "Averidge Income", y = "Abortions per capita in %") + 
  transition_states(Year, transition_length = 12, state_length = 1, wrap = TRUE) +
   theme(axis.text.x = element_text(size = 12), #here we change the size of the labels.
          axis.text.y = element_text(size = 12),
          text = element_text(size = 16),
          plot.title = element_text(hjust = 0.5))

```




This visualization shows the growth in income in the differen municipalities from your 1995 to 2018.
```{r Visualization 3. Growth in income per in each municipality}
ui <- fluidPage(
    plotlyOutput("distPlot")
)

server <- function(input, output) {
   output$distPlot <- renderPlotly({
      qplot(x = av_Income, y = Year, size = av_Income, color = Municipalities, data = final_df) + 
       labs(title = "Visualization 2: Income growth", x = "Average Income in Municipalities", y = "Years")+
      geom_point()
   })
}

shinyApp(ui = ui, server = server)

```



This visualization only shows Lolland, Langeland, Gentofte and Rudersdals data for the years 1995 to 2018 and their development in abortions per capita as these Municipalities are approximately richest 2 municipalities and the poorest 
```{r Visualization 4. Devellopment for richest and poorest municipalities}

small_big_df <- final_df[(final_df$Municipalities == "Lolland" | final_df$Municipalities =="Gentofte" | final_df$Municipalities =="Rudersdal" | final_df$Municipalities == "Langeland"),] #creating a data frame that only consist of 4 municipalities.

#small_big_df


ui <- fluidPage(
    plotlyOutput("distPlot")
)

server <- function(input, output) {
   output$distPlot <- renderPlotly({
      qplot(x = Year, y = allAges, size = av_Income, color = Municipalities, data = small_big_df) + 
       labs(title = "Visualization 3: Poor and Rich", x = "Years", y = "Abotions per capita in %")+
      geom_point()
   })
}

shinyApp(ui = ui, server = server)




```




This code chunk below a static interactive plot to investigate the development in abortions per capita for every year in each municipality.
```{r Visualization 2.  scatter plot, abortions per person in all years}

#Scatter plot that shows abortions per person in all years and for all Municipalities

ui <- fluidPage(
    plotlyOutput("distPlot")
)

server <- function(input, output) {
   output$distPlot <- renderPlotly({
      qplot(allAges, Year, size = av_Income, color = Municipalities, data = final_df) + 
      labs(title = "Visualization 4: of abortions per capita from 1995-2018", x = "Abortions per capita in %", y = "Years") +
      geom_point()
   })
}

shinyApp(ui = ui, server = server)


```

