---
title: "Make_Abortions_Move_Again"
author: "Emil"
date: "26/11/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```



```{r }

library(tidyverse)
library(gganimate) # Her loades en pakke til at kunne lave visualiseringer
library(gifski) # Her loades en pakke, så vi kan vise visualiseringer som bevæger sig, længere nede.
library(ggplot2)

```
Okay, now that we have the tools we need from the library, we will download the data we would like to visualize

```{r}
head(final_df)



```


```{r}

theme_set(theme_bw())  # set theme to white background for better visibility

ggplot(subset(final_df, Year == 1995), aes(Abor_pr_capita, Municipalities, size = Income_pr_capita)) + 
  geom_point()



```


```{r, Q2}
final_df %>%  #We choose to look at the gapminder dataset and add pipes to it, so we can send an output of one fucntion directly to another.
  filter(Year == 2018) %>%  #First we filter the years in tha dataset so vi are only looking at data from 1952
  select(Municipalities , Income_pr_capita) %>% #then we select or choose to look at the countries and their gdpPercap, as everything else is irelevant right now
  arrange(desc(Income_pr_capita)) #lastly, we arange our data in a decending order so we have the richest nation first.

```

```{r}

søjle <- ggplot(subset(final_df, Year == 2000), aes(x=Municipalities, y=Abor_pr_capita, color =  Income_pr_capita)) +
  geom_bar(stat="identity")

søjle




```



```{r}
kbh <- ggplot(subset(final_df, Municipalities == Municipalities[1:50]), aes( x = Year, y = Abor_pr_capita, size = Income_pr_capita, color = Municipalities)) +
  geom_point() + #geom_point() gør at vi får scatter plots altså prikker i vores kordinatsystem
  transition_time(Year) +
  scale_x_log10() +
  transition_states(Year, transition_length = 12, state_length = 1, wrap = TRUE)
kbh


```








The code chunkbelow uses our final dataset to show the development in abortions per capita in procent along with the average income in the different municipalities in Denmark.

```{r}
options(scipen=999) #By adding this line of code we disable the scientific way of writing lables.
ggplot(final_df, aes(x = Income_pr_capita, y = Abor_pr_capita, size = Income_pr_capita))+
  geom_point() + 
 # scale_x_log10() + 
  transition_time(Year) + 
  labs(title = "{closest_state}", x = "Income per capita", y = "Abortions per capita") + 
  transition_states(Year, transition_length = 12, state_length = 1, wrap = TRUE) +
   theme(axis.text.x = element_text(size = 12), #here we change the size of the labels.
          axis.text.y = element_text(size = 12),
          text = element_text(size = 16),
          plot.title = element_text(hjust = 0.5))

```



