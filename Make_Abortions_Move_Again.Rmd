---
title: "Make_Abortions_Move_Again"
author: "Emil"
date: "26/11/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```



```{r }

library(tidyverse)
library(gganimate) # Her loades en pakke til at kunne lave visualiseringer
library(gifski) # Her loades en pakke, så vi kan vise visualiseringer som bevæger sig, længere nede.
library(ggplot2)
library(shiny)
library(plotly)

```
Okay, now that we have the tools we need from the library, we will download the data we would like to visualize

```{r}

head(final_df,26)
```


```{r}

theme_set(theme_bw())  # set theme to white background for better visibility

ggplot(subset(final_df, Year == 2018), aes(allAges, Municipalities, size = av_Income)) + 
  geom_point()



```






```{r}

ui <- fluidPage(
    plotlyOutput("distPlot")
)

server <- function(input, output) {
   output$distPlot <- renderPlotly({
      qplot(allAges, Year, size = av_Income, color = Municipalities, data = final_df) + 
      geom_point()
   })
}

shinyApp(ui = ui, server = server)



#__________________________________________________________________
ui <- fluidPage(
    plotlyOutput("distPlot")
)

server <- function(input, output) {
   output$distPlot <- renderPlotly({
        ggplot(subset(final_df05_18, Year == 2018), aes(allAges, av_age, size = av_Income, color = Municipalities)) + 
        geom_point()
   })
}

shinyApp(ui = ui, server = server)

#Cool visualisation that shows averidge abortions per capita on the x-axis and the average age in the different municipalities on the y-axis






#____________________________________________________________________

ui <- fluidPage(
    plotlyOutput("distPlot")
)

server <- function(input, output) {
   output$distPlot <- renderPlotly({
      ggplot(subset(final_df, Year == 2018), aes(x=Municipalities, y=allAges, color =  av_Income)) +
  geom_bar(stat="identity")
   })
}

shinyApp(ui = ui, server = server)

```


```{r, Q2}
final_df %>%  #We choose to look at the gapminder dataset and add pipes to it, so we can send an output of one fucntion directly to another.
  filter(Year == 2018) %>%  #First we filter the years in tha dataset so vi are only looking at data from 1952
  select(Municipalities , allAges) %>% #then we select or choose to look at the countries and their gdpPercap, as everything else is irelevant right now
  arrange(desc(allAges)) #lastly, we arange our data in a decending order so we have the richest nation first.



final_df05_18 %>%  #We choose to look at the gapminder dataset and add pipes to it, so we can send an output of one fucntion directly to another.
  filter(Year == 2018) %>%  #First we filter the years in tha dataset so vi are only looking at data from 1952
  select(Municipalities , av_age) %>% #then we select or choose to look at the countries and their gdpPercap, as everything else is irelevant right now
  arrange((av_age))

```

```{r}

søjle <- ggplot(subset(final_df, Year == 2018), aes(x=Municipalities, y=allAges, color =  av_Income)) +
  geom_bar(stat="identity")

søjle




```



```{r}
kbh <- ggplot(subset(final_df, Municipalities == Municipalities), aes( x = Year, y = allAges, size = av_Income)) +
  geom_point() + #geom_point() gør at vi får scatter plots altså prikker i vores kordinatsystem
  transition_time(Year) +
  #scale_x_log10() +
  transition_states(Year, transition_length = 12, state_length = 1, wrap = TRUE)
kbh


```








The code chunkbelow uses our final dataset to show the development in abortions per capita in procent along with the average income in the different municipalities in Denmark.

```{r}
options(scipen=999) #By adding this line of code we disable the scientific way of writing lables.
ggplot(final_df, aes(x = av_Income, y = allAges, size = av_Income))+
  geom_point() + 
 # scale_x_log10() + 
  transition_time(Year) + 
  labs(title = "{closest_state}", x = "Averidge Income", y = "Abortions per capita") + 
  transition_states(Year, transition_length = 12, state_length = 1, wrap = TRUE) +
   theme(axis.text.x = element_text(size = 12), #here we change the size of the labels.
          axis.text.y = element_text(size = 12),
          text = element_text(size = 16),
          plot.title = element_text(hjust = 0.5))


```








```{r}



```







